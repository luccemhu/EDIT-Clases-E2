---
title: "Regresión lineal multivariada (II)"
author: "Gianfranco Raúl Romero Sucapuca"
date: '2022-05-06'
output: html_document
---

#Regresión lineal

La regresión lineal busca proponer un modelo, es decir una ecuación, que recoja como una variable explicaría a otra. La regresión lineal es también conocida como la *Regresión Gaussiana*, la cual es aplicable sólo cuando la *variable dependiente* es numérica, contínua, y no acotada.

#Caso de estudio: Pavimentando con votos

H1: La asignación presupuestal en infraestructura vial en Colombia responde a los criterios técnicos y económicos determinados en el Plan Nacional de Desarrollo y otros documentos de carácter técnico elaborados por el gobierno.

H2: La asignación presupuestal en infraestructura vial en Colombia responde a negociaciones bilaterales entre el ejecutivo y el legislativo basadas en necesidades políticas y electorales de corto plazo.

H3: La asignación presupuestal en infraestructura vial en Colombia responde al esfuerzo del gobierno por fortalecer su base social de apoyo local a través de los Consejos Comunales de Gobierno.

#Preparación de los datos

```{r}
#carga de data
linkToData = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSRpCC8gKIxMxpK0wjgLcl-GQWdw6sAeB16Sixkq6kZXeTfMS8_n70twbEbQ2tMcGp8tm-6x8qf8ieo/pub?gid=234740779&single=true&output=csv'
pavi = read.csv(linkToData)
str(pavi)
```

```{r}
seleccion = c("consejocomunal", "ejecucion", "uribista", "priorizado")
pavi[, seleccion] = lapply(pavi[, seleccion], as.factor)
```

*Hipótesis* El Beneficio recibido en un municipio ha sido afectado por el porcentaje de votos recibidos por los candidatos de la oposición a Uribe a la camara de representantes, controlando por tamaño de población.

```{r}
modelo1 = formula(apropiaciondolar ~ pctopo + poblacioncienmil)
```

```{r}
library(stargazer)
reg1 = lm(modelo1, data = pavi)
stargazer(reg1, type = "text", intercept.bottom = FALSE)
```

Al probar esta hipótesis vemos, primero que pctopo tiene efecto significativo al 0.1 (indicado por el asterisco); segundo, que ese efecto es inverso, pues el coeficiente calculado es negativo; y tercero que la magnitud de ese efecto es -0.035, lo que indica cuanto varía apropiaciondolar en promedio cuando pctopo se incremente en una unidad, controlando por poblacioncienmil.

Justamente el R cuadrado ajustado (0.1109157) nos brinda un porcentaje (multiplicalo por 100) que da una pista de nuestra cercanía a una situación perfecta (cuando vale 1).

¿Y sí queremos ver el efecto de la promesa de ejecución (ejecucion)?

```{r}
modelo2 = formula(apropiaciondolar ~ pctopo + consejocomunal + poblacioncienmil)
```

```{r}
reg2 = lm(modelo2, data = pavi)
stargazer(reg2, type = "text", intercept.bottom = FALSE)
```

Al probar esta hipótesis vemos, que pctopo tiene efecto significativo al 0.1 (indicado por el asterisco); ese efecto es inverso, pues el coeficiente calculado es negativo; y la magnitud de ese efecto es -0.033, lo que indica cuanto varía apropiaciondolar en promedio cuando pctopo se incremente en una unidad, controlando por poblacioncienmil. Así mismo, vemos que consejocomunal tiene efecto significativo al 0.001 (indicado por los asteriscos); ese efecto es directo, pues el coeficiente calculado es positivo; y la magnitud de ese efecto es 12.723, lo que indica cuanto varía apropiaciondolar en promedio cuando consejocomunal es 1 y no 0 (también controlando por poblacioncienmil).

Nótese la lectura del efecto cuando la variable independiente es categórica (o factor). Primero, nota que R indica el valor 1 con el nombre de la variable: eso indica que el valor 0 (cuando el consejo comunal de ese municipio NO fue visitado) es la categoría de referencia; es decir, el coeficiente nos indica cuanto se modifica el valor promedio de la dependiente cuando se pasa de 0 a 1. Si la variable independiente es politómica (no ordinal), aparecerá cada categoría menos la de referencia, y el efecto siempre se debe interpretar como el efecto de la variable mostrada versus la de referencia.

Comparamos ambos modelos con la prueba anova

```{r}
tanova = anova(reg1, reg2)
stargazer(tanova,
          type = 'text',
          summary = F,
          title = "Table de Análisis de Varianza")
```































